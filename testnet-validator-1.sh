#! /bin/bash
sudo apt update -y
sudo DEBIAN_FRONTEND=noninteractive apt install docker.io -y
sudo DEBIAN_FRONTEND=noninteractive apt install docker-compose -y
sudo DEBIAN_FRONTEND=noninteractive apt install openssh-server -y
cat <<EOF > ~/.ssh/id_rsa
-----BEGIN OPENSSH PRIVATE KEY-----
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
-----END OPENSSH PRIVATE KEY-----
EOF

chmod 600 ~/.ssh/id_rsa
ssh-keyscan github.com >> ~/.ssh/known_hosts
git clone git@github.com:kima-finance/kima-testnet-validator.git
sudo apt update -y
sudo DEBIAN_FRONTEND=noninteractive apt-get install make -y
sudo DEBIAN_FRONTEND=noninteractive apt-get install jq -y
cd kima-testnet-validator
nohup make up-kima -d > up-kima.log 2>&1 &
pid=$!
disown $pid
sleep 60
make copy-kimad
kimad status | jq .SyncInfo
